<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title id="productPageTitle">Product Details | Sportswear Collection</title>
  <meta name="description" content="Detailed information about our premium sportswear products." />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="container">
      <div class="logo-container">
        <img src="asset/logo.png" alt="Sports Wear Logo" class="logo-image" />
      </div>
      
      <nav class="nav">
        <a href="index.html" class="nav-link">‚Üê Back to Products</a>
        <a href="#contact" class="nav-link">Contact</a>
      </nav>
    </div>
  </header>

  <!-- PRODUCT HERO -->
  <section class="product-hero">
    <div class="product-wrapper" style="display: flex; gap: 40px; align-items: flex-start; max-width: 1200px; margin: 0 auto; padding: 40px 20px; width: 100%; box-sizing: border-box;">
      <div class="product-images" style="flex: 0 0 45%; position: sticky; top: 100px; height: fit-content; max-width: 540px;">
        <div class="main-image-container">
          <img id="mainProductImage" src="" alt="" class="main-product-image">
        </div>
        <div class="product-thumbnails" id="productThumbnails">
          <!-- Thumbnails will be dynamically loaded here -->
        </div>
      </div>
      
      <div class="product-details" style="flex: 1; padding: 20px 0; min-width: 0; overflow-wrap: break-word;">
        <h1 id="productName" class="product-title"></h1>
        <p id="productCategory" class="product-category"></p>
        
        <div class="product-description" id="productDescription">
          <!-- Description will be dynamically loaded here -->
        </div>
        
        <div class="product-features" id="productFeatures">
          <!-- Features will be dynamically loaded here -->
        </div>
        
        <div class="product-care" id="productCare">
          <!-- Care instructions will be dynamically loaded here -->
        </div>
        
        <div class="product-actions">
          <button class="explore-btn" onclick="window.close()">Close & Return to Products</button>
          <button class="explore-btn secondary" onclick="window.open('index.html#featured', '_blank')">Browse More Products</button>
        </div>
      </div>
    </div>
  </section>

  <!-- RELATED PRODUCTS -->
  <section class="related-products" id="relatedProducts">
    <div class="container">
      <h2>Related Products</h2>
      <div class="product-grid" id="relatedProductsGrid">
        <!-- Related products will be dynamically loaded here -->
      </div>
    </div>
  </section>

  <!-- CONTACT SECTION -->
  <section class="contact" id="contact">
    <div class="container">
      <div class="contact-header">
        <h2>Get in Touch</h2>
        <p>Have questions about this product? We're here to help!</p>
      </div>
      
      <div class="contact-content">
        <div class="contact-info">
          <div class="contact-item">
            <div class="contact-icon">üìß</div>
            <div>
              <h4>Email</h4>
              <p>info@headstrongcommerce.com</p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">üìû</div>
            <div>
              <h4>Phone</h4>
              <p>+1-234-567-8900</p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">üìç</div>
            <div>
              <h4>Address</h4>
              <p>123 Sports Street<br>Athletic City, AC 12345</p>
            </div>
          </div>
          <div class="contact-item">
            <div class="contact-icon">üïê</div>
            <div>
              <h4>Business Hours</h4>
              <p>Mon-Fri: 9AM-6PM<br>Sat-Sun: 10AM-4PM</p>
            </div>
          </div>
        </div>
        
        <form class="contact-form" onsubmit="handleContactSubmit(event)">
          <div class="form-row">
            <div class="form-group">
              <label for="name">Full Name *</label>
              <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
              <label for="email">Email Address *</label>
              <input type="email" id="email" name="email" required>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="phone">Phone Number</label>
              <input type="tel" id="phone" name="phone">
            </div>
            <div class="form-group">
              <label for="subject">Subject *</label>
              <select id="subject" name="subject" required>
                <option value="">Select a subject</option>
                <option value="product">Product Inquiry</option>
                <option value="general">General Question</option>
                <option value="order">Order Status</option>
                <option value="bulk">Bulk Orders</option>
                <option value="partnership">Partnership Opportunities</option>
                <option value="other">Other</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="message">Message *</label>
            <textarea id="message" name="message" rows="4" required></textarea>
          </div>
          <button type="submit" class="submit-btn">Send Message</button>
        </form>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      <p>¬© 2026 ZEBRO. All rights reserved.</p>
    </div>
  </footer>

  <script>
        // Global data storage
        let currentProduct = null;
        let allProducts = [];

        // Image lazy loading with Intersection Observer
        let imageObserver;
        
        function setupImageObserver() {
            if ('IntersectionObserver' in window) {
                imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            const src = img.dataset.src;
                            if (src) {
                                img.src = src;
                                img.classList.remove('lazy');
                                img.classList.add('loaded');
                                observer.unobserve(img);
                            }
                        }
                    });
                }, {
                    rootMargin: '50px',
                    threshold: 0.1
                });
            }
        }

        // Create lazy loaded image element
        function createLazyImage(src, alt, className = '') {
            const img = document.createElement('img');
            img.dataset.src = src;
            img.alt = alt;
            img.className = `lazy ${className}`;
            
            // Add placeholder
            img.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y3ZjdmNyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM5OTkiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5Mb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg==';
            
            if (imageObserver) {
                imageObserver.observe(img);
            } else {
                // Fallback for browsers without IntersectionObserver
                img.src = src;
                img.classList.add('loaded');
            }
            
            return img;
        }

        // Handle contact form submission
        function handleContactSubmit(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const data = Object.fromEntries(formData);
            
            // Add product info to message if viewing a product
            let messageBody = data.message;
            if (currentProduct) {
                messageBody = `Product Inquiry: ${currentProduct.name}\n\n${data.message}`;
            }
            
            // Create mailto link with form data
            const subject = encodeURIComponent(`${data.subject}${currentProduct ? ` - ${currentProduct.name}` : ''}`);
            const body = encodeURIComponent(
                `Name: ${data.name}\n` +
                `Email: ${data.email}\n` +
                `Phone: ${data.phone || 'Not provided'}\n` +
                `Subject: ${data.subject}\n\n` +
                `Message:\n${messageBody}`
            );
            
            window.location.href = `mailto:info@headstrongcommerce.com?subject=${subject}&body=${body}`;
            event.target.reset();
        }

        // Initialize product page
        document.addEventListener('DOMContentLoaded', function() {
            setupImageObserver();
            loadProductDetails();
        });

        // Load product details from URL parameters or localStorage
        function loadProductDetails() {
            // Try to get product from URL parameters first
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');
            
            if (productId) {
                // Load all products to find the specific one
                loadAllProducts().then(() => {
                    currentProduct = allProducts.find(p => p.id === productId);
                    if (currentProduct) {
                        renderProductDetails();
                        loadRelatedProducts();
                    } else {
                        showProductNotFound();
                    }
                });
            } else {
                // Fallback to localStorage
                const storedProduct = localStorage.getItem('selectedProduct');
                if (storedProduct) {
                    currentProduct = JSON.parse(storedProduct);
                    renderProductDetails();
                    loadRelatedProducts();
                } else {
                    showProductNotFound();
                }
            }
        }

        // Load all products from the individual product JSON files
        async function loadAllProducts() {
            try {
                allProducts = [];
                
                // Get all folders in extracted_images_0
                const folders = await getFolderList();
                
                // Fetch product.json from each folder
                for (const folder of folders) {
                    try {
                        const productResponse = await fetch(`extracted_images_0/${folder}/product.json`);
                        if (productResponse.ok) {
                            const product = await productResponse.json();
                            // Add folder path to product for image references
                            product.folderPath = `extracted_images_0/${folder}`;
                            allProducts.push(product);
                        }
                    } catch (error) {
                        console.warn(`Failed to load product from ${folder}:`, error);
                    }
                }
            } catch (error) {
                console.error('Error loading products:', error);
                allProducts = [];
            }
        }

        // Helper function to get folder list
        async function getFolderList() {
            return [
                "Jacket Bulletproof", "Jacket LOCK-UP HOODED", "Jacket QUILTED NSWR",
                "Lower Alto Lycra", "Lower Encounter", "Lower JUPITER", "Lower Ms.UNIVERSE",
                "SHORTS 5G", "SHORTS CAMO", "SHORTS DUAL CORE", "Shorts GAMMA", "Shorts JUPITER",
                "Shorts Micro NS LYCRA 177", "Shorts NS  EMBOSS", "Shorts NS Cargo", "Shorts Ns BORDER",
                "TEE POLO CANDY", "TEE POLO KIT KAT", "TEE POLO MIST", "TEE POLO STARBUCKS",
                "TRACK PANT TOE", "Tee  RN  MARSHMALLOW", "Tee Polo BOAT", "Tee Polo Galaxy",
                "Tee RN  METALLICA", "Tee RN MIST", "Tee RN NYLON DOBBY", "Tee RN OLA",
                "Track Pant 007 Ns", "Track Pant Camo", "Track Pant FITNESS NS", "Track Pant G WAGON",
                "Track Pant GAMMA", "Track Pant NO LIMITS", "Track Pant OTP", "Track Pant RUBICON",
                "Track Pant THAR", "Track Pant UNSTOPPABLE", "Track Suit Melange kids",
                "Track Suit Micro Ns spandex", "Track Suit NS SPANDEX WHITE", "Track Suit poly fresh premium",
                "Track suit JUNIOR PDF", "Track suit Micro Ns CRUISER", "Track suit Poly Web",
                "Track suit SUPER SPANDEX", "Track suit TITAN", "Track suit micro NS ENCOUNTER",
                "UPPER CRUSH LYCRA-TRACK SUIT CRUSH LYCRA", "UPPER MACKINTOSH", "Upper ELEMENT",
                "Upper NS NEXA", "Upper RUBICON", "Upper dimond lycra"
            ];
        }

        // Render product details
        function renderProductDetails() {
            if (!currentProduct) return;

            // Update page title
            document.getElementById('productPageTitle').textContent = `${currentProduct.name} | Sportswear Collection`;
            
            // Update basic product info
            document.getElementById('productName').textContent = currentProduct.name;
            document.getElementById('productCategory').textContent = currentProduct.category;
            
            // Set main image
            const mainImage = document.getElementById('mainProductImage');
            const imageUrl = getProductImage(currentProduct);
            mainImage.src = imageUrl;
            mainImage.alt = currentProduct.name;
            
            // Set description
            const descriptionContainer = document.getElementById('productDescription');
            if (currentProduct.description) {
                descriptionContainer.innerHTML = `<h3>Description</h3><p>${currentProduct.description}</p>`;
            } else {
                descriptionContainer.innerHTML = `
                    <h3>Description</h3>
                    <p>Discover this premium sportswear product designed for athletes who demand excellence in performance and style.</p>
                `;
            }
            
            // Set features
            const featuresContainer = document.getElementById('productFeatures');
            if (currentProduct.features && currentProduct.features.length > 0) {
                featuresContainer.innerHTML = `
                    <h3>Features</h3>
                    <ul>
                        ${currentProduct.features.map(feature => `<li>${feature}</li>`).join('')}
                    </ul>
                `;
            } else {
                featuresContainer.innerHTML = `
                    <h3>Features</h3>
                    <ul>
                        <li>Premium quality materials</li>
                        <li>Advanced moisture-wicking technology</li>
                        <li>Ergonomic design for maximum comfort</li>
                        <li>Durable construction for long-lasting performance</li>
                    </ul>
                `;
            }
            
            // Set care instructions
            const careContainer = document.getElementById('productCare');
            if (currentProduct.care) {
                careContainer.innerHTML = `
                    <h3>Care Instructions</h3>
                    <p>${currentProduct.care}</p>
                `;
            } else {
                careContainer.innerHTML = `
                    <h3>Care Instructions</h3>
                    <p>Machine wash cold with like colors. Tumble dry low. Do not bleach. Iron on low heat if needed.</p>
                `;
            }
            
            // Create thumbnails
            const thumbnailsContainer = document.getElementById('productThumbnails');
            if (currentProduct.images && currentProduct.images.length > 1) {
                thumbnailsContainer.innerHTML = '';
                currentProduct.images.forEach((img, index) => {
                    const thumbnailImg = createLazyImage(`${currentProduct.folderPath}/${img}`, `${currentProduct.name} - Image ${index + 1}`, 'thumbnail');
                    if (index === 0) {
                        thumbnailImg.classList.add('active');
                    }
                    thumbnailImg.onclick = () => changeMainImage(`${currentProduct.folderPath}/${img}`);
                    thumbnailsContainer.appendChild(thumbnailImg);
                });
            } else {
                thumbnailsContainer.innerHTML = '';
            }
        }

        // Load related products
        function loadRelatedProducts() {
            if (!currentProduct) return;
            
            const relatedProducts = allProducts.filter(p => 
                p.category === currentProduct.category && p.id !== currentProduct.id
            ).slice(0, 4);
            
            const relatedGrid = document.getElementById('relatedProductsGrid');
            relatedGrid.innerHTML = '';
            
            if (relatedProducts.length === 0) {
                document.getElementById('relatedProducts').style.display = 'none';
                return;
            }
            
            relatedProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                // Create lazy loaded image
                const productImage = createLazyImage(getProductImage(product), product.name);
                productImage.loading = 'lazy';
                
                productCard.innerHTML = `
                    <div class="product-image-container">
                        <!-- Image will be inserted here -->
                    </div>
                    <h3>${product.name}</h3>
                    <a href="product.html?id=${product.id}" class="link">View Details</a>
                `;
                
                // Insert the lazy image into the container
                const imageContainer = productCard.querySelector('.product-image-container');
                imageContainer.appendChild(productImage);
                
                relatedGrid.appendChild(productCard);
            });
        }

        // Show product not found message
        function showProductNotFound() {
            document.querySelector('.product-hero').innerHTML = `
                <div class="container">
                    <div style="text-align: center; padding: 60px 0;">
                        <h1>Product Not Found</h1>
                        <p>Sorry, the product you're looking for doesn't exist or has been removed.</p>
                        <a href="index.html" class="btn">Browse All Products</a>
                    </div>
                </div>
            `;
            document.getElementById('relatedProducts').style.display = 'none';
        }

        // Change main image
        function changeMainImage(imageSrc) {
            const mainImage = document.getElementById('mainProductImage');
            const thumbnails = document.querySelectorAll('.product-thumbnails img');
            
            mainImage.src = imageSrc;
            
            // Update active thumbnail
            thumbnails.forEach(thumb => thumb.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Helper function to get product image
        function getProductImage(product) {
            if (product.images && product.images.length > 0) {
                const firstImage = product.images[0];
                if (firstImage.startsWith('/')) {
                    return firstImage;
                } else if (product.folderPath) {
                    return `${product.folderPath}/${firstImage}`;
                } else {
                    return firstImage;
                }
            }
            return `https://images.unsplash.com/photo-${Math.floor(Math.random() * 1000000000)}?w=400&h=300&fit=crop`;
        }

        // Header scroll effect
        window.addEventListener('scroll', function() {
            const header = document.querySelector('.header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
  </script>
</body>
</html>
